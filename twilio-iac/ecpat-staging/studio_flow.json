{
  "description": "Bot flow for creating a Flex messaging task",
  "states": [
    {
      "name": "Trigger",
      "type": "trigger",
      "transitions": [
        {
          "next": "LanguageBot",
          "event": "incomingMessage"
        },
        {
          "event": "incomingCall"
        },
        {
          "event": "incomingConversationMessage"
        },
        {
          "event": "incomingRequest"
        },
        {
          "event": "incomingParent"
        }
      ],
      "properties": {
        "offset": {
          "x": -1180,
          "y": -1350
        }
      }
    },
    {
      "name": "smsAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -170,
          "y": 1460
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "ChatBot",
      "type": "send-to-auto-pilot",
      "transitions": [
        {
          "next": "check_counselor_handoff",
          "event": "sessionEnded"
        },
        {
          "event": "failure"
        }
      ],
      "properties": {
        "chat_channel": "{{trigger.message.ChannelSid}}",
        "offset": {
          "x": -1350,
          "y": 620
        },
        "autopilot_assistant_sid": "UAc4e9ea44e783a6340ac18b5d74c8bfc9",
        "from": "Bot",
        "chat_service": "{{trigger.message.InstanceSid}}",
        "body": "{{trigger.message.Body}}",
        "target_task": "greeting",
        "timeout": 14400
      }
    },
    {
      "name": "check_counselor_handoff",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "AdjustAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to counselor_handoff",
              "arguments": [
                "{{widgets.ChatBot.CurrentTask}}"
              ],
              "type": "equal_to",
              "value": "counselor_handoff"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.ChatBot.CurrentTask}}",
        "offset": {
          "x": -1490,
          "y": 930
        }
      }
    },
    {
      "name": "defaultAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -840,
          "y": 1530
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC18923afb2fdc485fbbd93a5df56e060e",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"helpline\": \"\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "whatsappAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -500,
          "y": 1490
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "facebookAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1300,
          "y": 1530
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\",\"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"language\":\"en-PH\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "webAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 180,
          "y": 1460
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"ip\":\"{{trigger.message.ChannelAttributes.pre_engagement_data.ip}}\",\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"helpline\": \"{{trigger.message.ChannelAttributes.pre_engagement_data.helpline}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "AdjustAttributes",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "defaultAttributes",
          "event": "noMatch"
        },
        {
          "next": "whatsappAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to whatsapp",
              "arguments": [
                "{{trigger.message.ChannelAttributes.channel_type}}"
              ],
              "type": "equal_to",
              "value": "whatsapp"
            }
          ]
        },
        {
          "next": "smsAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to sms",
              "arguments": [
                "{{trigger.message.ChannelAttributes.channel_type}}"
              ],
              "type": "equal_to",
              "value": "sms"
            }
          ]
        },
        {
          "next": "webAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to web",
              "arguments": [
                "{{trigger.message.ChannelAttributes.channel_type}}"
              ],
              "type": "equal_to",
              "value": "web"
            }
          ]
        },
        {
          "next": "facebookAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to facebook",
              "arguments": [
                "{{trigger.message.ChannelAttributes.channel_type}}"
              ],
              "type": "equal_to",
              "value": "facebook"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{trigger.message.ChannelAttributes.channel_type}}",
        "offset": {
          "x": -890,
          "y": 1210
        }
      }
    },
    {
      "name": "LanguageBot",
      "type": "send-to-auto-pilot",
      "transitions": [
        {
          "next": "split_language",
          "event": "sessionEnded"
        },
        {
          "event": "failure"
        },
        {
          "event": "timeout"
        }
      ],
      "properties": {
        "chat_channel": "{{trigger.message.ChannelSid}}",
        "offset": {
          "x": -1070,
          "y": -1160
        },
        "autopilot_assistant_sid": "UA19ad9f719702d7b5f8e6d03c8d38d57f",
        "from": "Bot",
        "chat_service": "{{trigger.message.InstanceSid}}",
        "body": "{{trigger.message.Body}}",
        "target_task": "greeting",
        "timeout": 14400
      }
    },
    {
      "name": "Permission",
      "type": "send-to-auto-pilot",
      "transitions": [
        {
          "next": "split_permission",
          "event": "sessionEnded"
        },
        {
          "event": "failure"
        },
        {
          "event": "timeout"
        }
      ],
      "properties": {
        "chat_channel": "{{trigger.message.ChannelSid}}",
        "offset": {
          "x": -1330,
          "y": 130
        },
        "autopilot_assistant_sid": "UA523ad5e5fe6685a7c51734d49243d344",
        "from": "Bot",
        "chat_service": "{{trigger.message.InstanceSid}}",
        "body": "{{trigger.message.Body}}",
        "target_task": "greeting",
        "timeout": 14400
      }
    },
    {
      "name": "split_language",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "split_reason",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains en-US",
              "arguments": [
                "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.languages.answer}}"
              ],
              "type": "contains",
              "value": "en-US"
            }
          ]
        },
        {
          "next": "split_reason_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains Filipino",
              "arguments": [
                "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.languages.answer}}"
              ],
              "type": "contains",
              "value": "Filipino"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.languages.answer}}",
        "offset": {
          "x": -1020,
          "y": -930
        }
      }
    },
    {
      "name": "split_permission",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "ChatBot",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains yes",
              "arguments": [
                "{{widgets.Permission.memory.twilio.collected_data.collect_permission.answers.permission.answer}}"
              ],
              "type": "contains",
              "value": "yes"
            }
          ]
        },
        {
          "next": "send_message_NO",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains no",
              "arguments": [
                "{{widgets.Permission.memory.twilio.collected_data.collect_permission.answers.permission.answer}}"
              ],
              "type": "contains",
              "value": "no"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.Permission.memory.twilio.collected_data.collect_permission.answers.permission.answer}}",
        "offset": {
          "x": -1710,
          "y": 370
        }
      }
    },
    {
      "name": "send_message_NO",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1800,
          "y": 620
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "to": "{{contact.channel.address}}",
        "body": "Please visit the ECPAT Philippines reporting page for anonymous reporting.\n\necpat.org.ph/report",
        "media_url": "ecpat.org.ph/report"
      }
    },
    {
      "name": "Permission_fil",
      "type": "send-to-auto-pilot",
      "transitions": [
        {
          "next": "split_fil",
          "event": "sessionEnded"
        },
        {
          "event": "failure"
        },
        {
          "event": "timeout"
        }
      ],
      "properties": {
        "chat_channel": "{{trigger.message.ChannelSid}}",
        "offset": {
          "x": 310,
          "y": 80
        },
        "autopilot_assistant_sid": "UA6fc1a13de69e8f6c431c815f0041c65a",
        "from": "Bot",
        "chat_service": "{{trigger.message.InstanceSid}}",
        "body": "{{trigger.message.Body}}",
        "target_task": "greeting",
        "timeout": 14400
      }
    },
    {
      "name": "no_permission_msg_fil",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -470,
          "y": 660
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "{{flow.channel.address}}",
        "to": "{{contact.channel.address}}",
        "body": "Mangyaring bisitahin ang hindi kilalang pahina ng pag-uulat ng ECPAT Philippines ecpat.org.ph/report",
        "media_url": "ecpat.org.ph/report"
      }
    },
    {
      "name": "split_fil",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "no_permission_msg_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains no",
              "arguments": [
                "{{widgets.Permission_fil.memory.twilio.collected_data.collect_permission.answers.Permission.answer}}"
              ],
              "type": "contains",
              "value": "no"
            }
          ]
        },
        {
          "next": "PreSurvey_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains yes",
              "arguments": [
                "{{widgets.Permission_fil.memory.twilio.collected_data.collect_permission.answers.Permission.answer}}"
              ],
              "type": "contains",
              "value": "yes"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.Permission_fil.memory.twilio.collected_data.collect_permission.answers.Permission.answer}}",
        "offset": {
          "x": -400,
          "y": 380
        }
      }
    },
    {
      "name": "PreSurvey_fil",
      "type": "send-to-auto-pilot",
      "transitions": [
        {
          "next": "check_counselor_fil",
          "event": "sessionEnded"
        },
        {
          "event": "failure"
        },
        {
          "event": "timeout"
        }
      ],
      "properties": {
        "chat_channel": "{{trigger.message.ChannelSid}}",
        "offset": {
          "x": -10,
          "y": 660
        },
        "autopilot_assistant_sid": "UA53dfe813bde66566c564214a2b019b2c",
        "from": "Bot",
        "chat_service": "{{trigger.message.InstanceSid}}",
        "body": "{{trigger.message.Body}}",
        "target_task": "greeting",
        "timeout": 14400
      }
    },
    {
      "name": "check_counselor_fil",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "AdjustAttributes_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to counselor_handoff",
              "arguments": [
                "{{widgets.PreSurvey_fil.CurrentTask}}"
              ],
              "type": "equal_to",
              "value": "counselor_handoff"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.PreSurvey_fil.CurrentTask}}",
        "offset": {
          "x": 30,
          "y": 920
        }
      }
    },
    {
      "name": "AdjustAttributes_fil",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "defaultAttributes",
          "event": "noMatch"
        },
        {
          "next": "facebookAttributes_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to facebook",
              "arguments": [
                "{{trigger.message.ChannelAttributes.channel_type}}"
              ],
              "type": "contains",
              "value": "facebook"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{trigger.message.ChannelAttributes.channel_type}}",
        "offset": {
          "x": 170,
          "y": 1200
        }
      }
    },
    {
      "name": "facebookAttributes_fil",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": 760,
          "y": 1430
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"language\":\"tl-PH\",\n\"memory\": {{widgets.PreSurvey_fil.memory | to_json}}}"
      }
    },
    {
      "name": "MalePref_facebookAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1400,
          "y": 2300
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"genderpreference\":\"male\",\"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"language\":\"en-US\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "FemalePref_facebookAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1670,
          "y": 2210
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\",\"genderpreference\":\"female\", \"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"language\":\"en-US\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "NonBin_facebookAttributes",
      "type": "send-to-flex",
      "transitions": [
        {
          "event": "callComplete"
        },
        {
          "event": "failedToEnqueue"
        },
        {
          "event": "callFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1030,
          "y": 2320
        },
        "workflow": "WWff6467a52ed6196efe78506d4274f60b",
        "channel": "TC8057a39cd3116ac03429d8f803b42035",
        "attributes": "{\"name\": \"{{trigger.message.ChannelAttributes.from}}\", \"genderpreference\":\"Non-binary\",\"channelType\": \"{{trigger.message.ChannelAttributes.channel_type}}\", \"channelSid\": \"{{trigger.message.ChannelSid}}\", \"twilioNumber\": \"{{trigger.message.ChannelAttributes.twilioNumber}}\", \"ignoreAgent\":\"\", \"transferTargetType\":\"\",\n\"language\":\"en-US\",\n\"memory\": {{widgets.ChatBot.memory | to_json}}}"
      }
    },
    {
      "name": "F_counselor_handoff",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "FemalePref_facebookAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to counselor_handoff",
              "arguments": [
                "{{widgets.ChatBot.CurrentTask}}"
              ],
              "type": "equal_to",
              "value": "counselor_handoff"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.ChatBot.CurrentTask}}",
        "offset": {
          "x": -1710,
          "y": 1990
        }
      }
    },
    {
      "name": "M_check_counselor_handoff",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "MalePref_facebookAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to counselor_handoff",
              "arguments": [
                "{{widgets.ChatBot.CurrentTask}}"
              ],
              "type": "equal_to",
              "value": "counselor_handoff"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.ChatBot.CurrentTask}}",
        "offset": {
          "x": -1370,
          "y": 2130
        }
      }
    },
    {
      "name": "NB_check_counselor_handoff",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "NonBin_facebookAttributes",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to counselor_handoff",
              "arguments": [
                "{{widgets.ChatBot.CurrentTask}}"
              ],
              "type": "equal_to",
              "value": "counselor_handoff"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.ChatBot.CurrentTask}}",
        "offset": {
          "x": -810,
          "y": 2150
        }
      }
    },
    {
      "name": "split_reason",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "send_and_reply_234",
          "event": "noMatch"
        },
        {
          "next": "Permission",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 1",
              "arguments": [
                "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.service.answer}}"
              ],
              "type": "equal_to",
              "value": "1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.service.answer}}",
        "offset": {
          "x": -1250,
          "y": -710
        }
      }
    },
    {
      "name": "split_reason_fil",
      "type": "split-based-on",
      "transitions": [
        {
          "next": "send_and_reply_234fil",
          "event": "noMatch"
        },
        {
          "next": "check_operatinghrs_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value equal_to 1",
              "arguments": [
                "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.service.answer}}"
              ],
              "type": "equal_to",
              "value": "1"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.LanguageBot.memory.twilio.collected_data.collect_survey.answers.service.answer}}",
        "offset": {
          "x": -580,
          "y": -700
        }
      }
    },
    {
      "name": "send_message_234_fil",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -550,
          "y": -110
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "to": "{{contact.channel.address}}",
        "body": "Salamat, malapit nang makipag-ugnayan ang aming team."
      }
    },
    {
      "name": "check_operatinghrs",
      "type": "run-function",
      "transitions": [
        {
          "next": "split_operating",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS45d1a256ef1c4fa2112f7accc40306c5",
        "environment_sid": "ZE730f552b9429ca7a2105c822ef7faae4",
        "offset": {
          "x": -1180,
          "y": -400
        },
        "function_sid": "ZHc6798fb7d700cd812589cf202bb166ca",
        "parameters": [
          {
            "value": "facebook",
            "key": "channel"
          }
        ],
        "url": "https://serverless-1270-production.twil.io/operatingHours"
      }
    },
    {
      "name": "split_operating",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "Permission",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains open",
              "arguments": [
                "{{widgets.check_operatinghrs.body}}"
              ],
              "type": "contains",
              "value": "open"
            }
          ]
        },
        {
          "next": "send_message_closed",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains holiday",
              "arguments": [
                "{{widgets.check_operatinghrs.body}}"
              ],
              "type": "contains",
              "value": "closed"
            }
          ]
        },
        {
          "next": "send_message_closed",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains holiday",
              "arguments": [
                "{{widgets.check_operatinghrs.body}}"
              ],
              "type": "contains",
              "value": "holiday"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.check_operatinghrs.body}}",
        "offset": {
          "x": -1250,
          "y": -190
        }
      }
    },
    {
      "name": "send_message_closed",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -1750,
          "y": -120
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "to": "{{contact.channel.address}}",
        "body": "Sorry, we are not available right now. Our counselors are available 9am-6pm, Monday - Sunday. If you need urgent help, please contact 911."
      }
    },
    {
      "name": "send_and_reply_234",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "send_message_replied",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -1610,
          "y": -470
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "body": "Please share your request details.",
        "timeout": "3600"
      }
    },
    {
      "name": "send_message_replied",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -2180,
          "y": -140
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "to": "{{contact.channel.address}}",
        "body": "Thank you, our team will reach out soon."
      }
    },
    {
      "name": "send_and_reply_234fil",
      "type": "send-and-wait-for-reply",
      "transitions": [
        {
          "next": "send_message_234_fil",
          "event": "incomingMessage"
        },
        {
          "event": "timeout"
        },
        {
          "event": "deliveryFailure"
        }
      ],
      "properties": {
        "offset": {
          "x": -610,
          "y": -430
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "body": "Pakibahagi ang mga detalye ng iyong kahilingan.",
        "timeout": "3600"
      }
    },
    {
      "name": "check_operatinghrs_fil",
      "type": "run-function",
      "transitions": [
        {
          "next": "split_operating_fil",
          "event": "success"
        },
        {
          "event": "fail"
        }
      ],
      "properties": {
        "service_sid": "ZS45d1a256ef1c4fa2112f7accc40306c5",
        "environment_sid": "ZE730f552b9429ca7a2105c822ef7faae4",
        "offset": {
          "x": -200,
          "y": -430
        },
        "function_sid": "ZHc6798fb7d700cd812589cf202bb166ca",
        "parameters": [
          {
            "value": "facebook",
            "key": "channel"
          }
        ],
        "url": "https://serverless-1270-production.twil.io/operatingHours"
      }
    },
    {
      "name": "send_message_closed_fil",
      "type": "send-message",
      "transitions": [
        {
          "event": "sent"
        },
        {
          "event": "failed"
        }
      ],
      "properties": {
        "offset": {
          "x": -180,
          "y": 50
        },
        "service": "{{trigger.message.InstanceSid}}",
        "channel": "{{trigger.message.ChannelSid}}",
        "from": "Bot",
        "to": "{{contact.channel.address}}",
        "body": "Paumanhin, hindi kami available sa ngayon. Ang aming mga tagapayo ay magagamit 9am-6pm, Lunes - Linggo. Kung kailangan mo ng agarang tulong, mangyaring makipag-ugnayan sa 911."
      }
    },
    {
      "name": "split_operating_fil",
      "type": "split-based-on",
      "transitions": [
        {
          "event": "noMatch"
        },
        {
          "next": "Permission_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains open",
              "arguments": [
                "{{widgets.check_operatinghrs_fil.body}}"
              ],
              "type": "contains",
              "value": "open"
            }
          ]
        },
        {
          "next": "send_message_closed_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains holiday",
              "arguments": [
                "{{widgets.check_operatinghrs_fil.body}}"
              ],
              "type": "contains",
              "value": "closed"
            }
          ]
        },
        {
          "next": "send_message_closed_fil",
          "event": "match",
          "conditions": [
            {
              "friendly_name": "If value contains holiday",
              "arguments": [
                "{{widgets.check_operatinghrs_fil.body}}"
              ],
              "type": "contains",
              "value": "holiday"
            }
          ]
        }
      ],
      "properties": {
        "input": "{{widgets.check_operatinghrs_fil.body}}",
        "offset": {
          "x": -60,
          "y": -190
        }
      }
    }
  ],
  "initial_state": "Trigger",
  "flags": {
    "allow_concurrent_calls": true
  }
}
